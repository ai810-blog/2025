<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.4.1">Jekyll</generator><link href="https://ai810-blog.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://ai810-blog.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2025-06-02T12:00:27+08:00</updated><id>https://ai810-blog.github.io/feed.xml</id><title type="html">AI810 Blog Post (20238037)</title><subtitle>Home to the 2025 ICLR Blogposts track </subtitle><entry><title type="html">Molecule Generation with Fragment Retrieval Augmentation</title><link href="https://ai810-blog.github.io/blog/analysing-the-spectral-biases-in-generative-models/" rel="alternate" type="text/html" title="Molecule Generation with Fragment Retrieval Augmentation"/><published>2025-06-01T00:00:00+08:00</published><updated>2025-06-01T00:00:00+08:00</updated><id>https://ai810-blog.github.io/blog/analysing-the-spectral-biases-in-generative-models</id><content type="html" xml:base="https://ai810-blog.github.io/blog/analysing-the-spectral-biases-in-generative-models/"><![CDATA[<h1 id="molecule-generation-with-fragment-retrieval-augmentation-f-rag">Molecule Generation with Fragment Retrieval Augmentation (f-RAG)</h1> <h2 id="introduction">Introduction</h2> <p>Fragment-based drug discovery (FBDD) is a powerful approach in modern pharmaceutical research, enabling the construction of new molecules by assembling known molecular fragments. Despite its success, traditional FBDD methods often limit exploration to known chemical spaces, constraining the novelty and diversity of generated molecules. The research paper <strong>“Molecule Generation with Fragment Retrieval Augmentation (f-RAG)”</strong> addresses this limitation by proposing a novel framework that integrates retrieval-augmented generation to significantly enhance the exploration-exploitation trade-off in molecule generation.</p> <h2 id="related-work">Related Work</h2> <p>Fragment-based molecule generation typically recombines existing molecular fragments to build new molecules. Notable methods include Junction Tree VAE (JT-VAE)<d-cite key="jin2018junction"></d-cite>, which structures molecules by combining large substructures with smaller fragments. Techniques like MARS<d-cite key="xie2021mars"></d-cite> and reinforcement learning-based methods<d-cite key="yang2021hit"></d-cite> also iteratively add or remove fragments guided by chemical properties. Genetic algorithm-based methods<d-cite key="jensen2019graph"></d-cite> further enhance fragment assembly using crossover and mutation, yet remain limited by initial fragment pools.</p> <p>Retrieval-augmented generation (RAG)<d-cite key="borgeaud2022improving"></d-cite>, popularized in natural language processing, incorporates external contextual data to guide generative models. In molecular applications, retrieval augmentation methods often use entire molecules as retrieval units to influence generation<d-cite key="liu2024conversational"></d-cite>. This contrasts with f-RAG, which innovatively retrieves fragments to guide molecular construction more precisely, significantly enhancing chemical novelty and diversity.</p> <h2 id="the-f-rag-framework">The f-RAG Framework</h2> <p>The f-RAG framework strategically employs two fragment retrieval methods:</p> <h3 id="hard-fragment-retrieval">Hard Fragment Retrieval</h3> <p>Hard fragments explicitly become building blocks of newly generated molecules. Fragments are derived from known molecular structures using an arm-linker-arm decomposition approach. Each fragment’s relevance is quantified by assessing its contribution to desired molecular properties:</p> \[\text{score}(F_j) = \frac{1}{|S(F_j)|} \sum_{(x, y) \in S(F_j)} y,\] <p>where $S(F_j)$ denotes molecules containing fragment $F_j$, and $y$ is a measure of the desired property.</p> <p>The selected fragments form partial sequences, guiding generation via motif extensions or linker insertions. This direct inclusion ensures generated molecules retain meaningful chemical properties derived from existing fragments.</p> <h3 id="soft-fragment-retrieval">Soft Fragment Retrieval</h3> <p>Soft fragments indirectly guide molecule generation without direct inclusion in the final structure. They provide context to the generative model, aiding the prediction of novel molecular fragments through embedding augmentation. The embeddings for hard and soft fragments are computed separately and integrated using a cross-attention mechanism:</p> \[h_{\text{input}} = \text{LM}_{0:L}(x_{\text{input}}), \quad h_k^{\text{soft}} = \text{LM}_{0:L}(F_k^{\text{soft}}),\] <p>followed by:</p> \[h = \text{softmax}\left(\frac{\text{Query}(h_{\text{input}}) \cdot \text{Key}(H_{\text{soft}})^\top}{\sqrt{d_{\text{Key}}}}\right) \cdot \text{Value}(H_{\text{soft}}).\] <p>This integration significantly boosts the generation of novel and chemically plausible fragments, promoting exploration beyond existing fragment spaces.</p> <h3 id="genetic-fragment-modification">Genetic Fragment Modification</h3> <p>To further enhance molecular novelty, genetic algorithms (GA) are employed post-generation. Using crossover and mutation operations, the GA continuously diversifies the fragment population, allowing exploration into previously uncharted chemical spaces.</p> <h2 id="training-the-f-rag-model">Training the f-RAG Model</h2> <p>f-RAG relies on the pre-trained molecular language model SAFE-GPT, keeping it frozen to preserve its extensive chemical knowledge. Training focuses exclusively on a lightweight fragment injection module with a self-supervised objective. This training involves decomposing molecules into fragments and predicting the most similar fragment based on embeddings, efficiently teaching the model to utilize soft fragments for informative guidance.</p> <h2 id="experimental-evaluation">Experimental Evaluation</h2> <p>f-RAG was extensively evaluated on multiple tasks, including the Practical Molecular Optimization (PMO) benchmark and tasks focused on optimizing docking scores, quantitative estimates of drug-likeness (QED), synthetic accessibility (SA), and molecular novelty.</p> <h3 id="results-and-discussion">Results and Discussion</h3> <p>f-RAG consistently outperformed existing methods on several metrics:</p> <ul> <li><strong>Optimization Performance:</strong> Achieved state-of-the-art performance across 12 out of 23 PMO benchmark tasks, significantly surpassing traditional and recent baselines.</li> <li><strong>Diversity, Novelty, Synthesizability:</strong> Maintained superior balance among these criteria, demonstrating an effective exploration-exploitation trade-off and generating high-quality drug candidates.</li> <li><strong>Docking Score Optimization:</strong> Produced molecules with higher binding affinities and improved drug-likeness and synthesizability across various protein targets.</li> </ul> <h3 id="ablation-studies">Ablation Studies</h3> <p>Detailed ablation studies underscored the essential contributions of each f-RAG component (hard retrieval, soft retrieval, genetic modifications). Particularly, soft fragment retrieval was crucial in achieving high molecular diversity and novelty without sacrificing performance.</p> <h2 id="conclusion-and-future-directions">Conclusion and Future Directions</h2> <p>f-RAG significantly advances fragment-based drug discovery through innovative retrieval augmentation and genetic modification techniques. Its robust performance across diverse evaluation criteria confirms its potential in practical drug discovery applications.</p> <p>Future research directions include:</p> <ul> <li><strong>Adaptive Retrieval Strategies:</strong> Dynamically adjusting retrieval strategies based on ongoing molecular population performance.</li> <li><strong>Multi-modal Data Integration:</strong> Incorporating additional modalities such as textual or structural biological data into the fragment retrieval process.</li> <li><strong>Scalability:</strong> Extending f-RAG to larger chemical libraries and more complex molecular scenarios, validating its applicability and robustness on broader scales.</li> </ul> <h2 id="code-availability">Code availability</h2> <p>The official code written by the authors for reproduction can be found at <a href="https://github.com/NVlabs/f-RAG">https://github.com/NVlabs/f-RAG</a>.</p>]]></content><author><name></name></author><summary type="html"><![CDATA[This paper introduces f-RAG, a novel framework for molecular generation that enhances fragment-based drug discovery through retrieval-augmented generation. By combining hard and soft fragment retrieval with genetic fragment modification, f-RAG guides a pre-trained molecular language model (SAFE-GPT) to generate novel, diverse, and synthesizable molecules. Hard fragments serve as structural constraints, soft fragments provide contextual guidance via cross-attention, and genetic operations enable exploration beyond known chemical space. Extensive experiments on benchmarks demonstrate that f-RAG achieves state-of-the-art performance in optimizing molecular properties while maintaining high novelty and synthesizability.]]></summary></entry><entry><title type="html">GenMol: A Drug Discovery Generalist with Discrete Diffusion</title><link href="https://ai810-blog.github.io/blog/analytical-simulated-dynamics/" rel="alternate" type="text/html" title="GenMol: A Drug Discovery Generalist with Discrete Diffusion"/><published>2025-06-01T00:00:00+08:00</published><updated>2025-06-01T00:00:00+08:00</updated><id>https://ai810-blog.github.io/blog/analytical-simulated-dynamics</id><content type="html" xml:base="https://ai810-blog.github.io/blog/analytical-simulated-dynamics/"><![CDATA[<h1 id="introduction">Introduction</h1> <p>Drug discovery is a multifaceted process that involves stages such as de novo generation, fragment-constrained design, hit identification, and lead optimization. Traditional generative models often specialize in specific tasks, requiring task-specific architectures or expensive retraining for new objectives. <strong>GenMol</strong> addresses this limitation by offering a <strong>generalist molecular generation framework</strong> based on <strong>masked discrete diffusion</strong> over <strong>fragment-based molecular representations (SAFE)</strong>. This approach allows GenMol to serve as a unified model across different phases of drug discovery with enhanced efficiency, flexibility, and chemical fidelity. Unlike prior autoregressive methods, GenMol enables <strong>bidirectional parallel decoding</strong> and effective <strong>contextual guidance</strong>, improving sample quality and reducing inference time.</p> <h1 id="related-work">Related Work</h1> <p><strong>Discrete Diffusion Models:</strong> Discrete diffusion has recently emerged as a compelling approach for generative modeling of categorical data. D3PM<d-cite key="peng2022d3pm"></d-cite> introduces the notion of forward masking via transition matrices and backward denoising conditioned on time. MDLM<d-cite key="sahoo2024simple"></d-cite>, adopted by GenMol, simplifies this by formulating the training as a time-weighted sum of masked language modeling (MLM) losses. This framework has shown promise in NLP but remains underexplored in molecular generation.</p> <p><strong>Fragment-based Molecular Generation:</strong> Fragment-based drug design (FBDD) focuses on assembling known chemical fragments to build novel molecules. Earlier methods like graph-based VAEs<d-cite key="jin2020multi"></d-cite>, RL-based molecule completion<d-cite key="yang2021hit"></d-cite>, and genetic algorithms<d-cite key="jensen2019graph"></d-cite> have utilized fragments as building blocks. However, these models often suffer from limited diversity or require extensive retraining for new tasks. More recent work such as f-RAG enhances fragment utility through retrieval-augmented generation, but still lacks the unification across multiple generation tasks.</p> <h1 id="background">Background</h1> <h2 id="masked-discrete-diffusion">Masked Discrete Diffusion</h2> <p>In masked discrete diffusion, a clean sequence $\mathbf{x}$ is progressively corrupted into a fully masked sequence $\mathbf{z}^t$ through a forward process:</p> \[q(\mathbf{z}^t_l | \mathbf{x}_l) = \text{Cat}(\alpha_t \mathbf{x}_l + (1 - \alpha_t) \mathbf{m})\] <p>Here, $\alpha_t$ denotes the retention probability of the original token. The reverse process is trained to recover $\mathbf{x}$ by predicting token distributions from masked sequences. The training objective integrates cross-entropy losses over all time steps:</p> \[\mathcal{L}_{\text{NELBO}} = \mathbb{E}_q \int_0^1 \frac{\alpha'_t}{1 - \alpha_t} \sum_l \log \langle \mathbf{x}_{\theta, l}(\mathbf{z}^t, t), \mathbf{x}_l \rangle \, dt\] <h2 id="safe-molecular-representation">SAFE Molecular Representation</h2> <p>SAFE encodes molecules as an unordered sequence of fragments, each represented by a contiguous block of non-canonical SMILES tokens. These fragments are extracted using the BRICS algorithm and joined with attachment point markers. Unlike traditional SMILES or graph representations, SAFE maintains permutation invariance on fragment order, making it ideal for <strong>non-autoregressive</strong> generation. This also enables intuitive operations like fragment masking and replacement for goal-directed tasks.</p> <h1 id="genmol-framework">GenMol Framework</h1> <h2 id="masked-diffusion-architecture">Masked Diffusion Architecture</h2> <p>GenMol utilizes a BERT-based transformer trained using the masked discrete diffusion objective over SAFE sequences. The key advantages are:</p> <ol> <li><strong>Parallel Decoding:</strong> Tokens are predicted simultaneously, accelerating generation.</li> <li><strong>Bidirectional Attention:</strong> The model conditions predictions on full context, improving coherence.</li> <li><strong>Fragment-Level Semantics:</strong> By operating on fragments, GenMol better aligns with chemists’ reasoning.</li> </ol> <p>The reverse sampling from the model is defined using temperature-controlled confidence sampling:</p> \[p^l_{\theta, i} = \frac{\exp(\log x^l_{\theta, i}(\mathbf{z}^t, t)/\tau)}{\sum_j \exp(\log x^l_{\theta, j}(\mathbf{z}^t, t)/\tau)}\] <h2 id="fragment-remasking">Fragment Remasking</h2> <p>To optimize molecules, GenMol introduces <strong>fragment remasking</strong>: a fragment in a candidate molecule is randomly selected, masked, and regenerated via diffusion. This facilitates local exploration:</p> \[y(f_k) = \frac{1}{|\mathcal{S}(f_k)|} \sum_{\mathbf{x} \in \mathcal{S}(f_k)} y(\mathbf{x})\] <p>Fragments with high average scores are favored for vocabulary updates, enabling iterative refinement. The remasking mechanism is analogous to Gibbs sampling over fragment configurations, promoting controlled diversity and optimization.</p> <h2 id="molecular-context-guidance-mcg">Molecular Context Guidance (MCG)</h2> <p>MCG provides <strong>classifier-free guidance</strong> for discrete diffusion. It interpolates between predictions on a given input and its noisier variant:</p> \[\log x^{(w)}_{\theta, l, i} = w \log x_{\theta, l, i} + (1 - w) \log x'_{\theta, l, i}\] <p>Here, $x’_{\theta}$ is the model’s output on a more degraded (further masked) version of the input. This guidance boosts sample quality in tasks requiring conditional generation.</p> <h1 id="experimental-evaluation">Experimental Evaluation</h1> <h2 id="de-novo-generation">De Novo Generation</h2> <p>GenMol generates 1,000 molecules and measures validity, uniqueness, diversity, and a composite <strong>quality</strong> metric (valid + QED ≥ 0.6 + SA ≤ 4). Results show:</p> <ul> <li><strong>Validity:</strong> 100%</li> <li><strong>Uniqueness:</strong> 99.7%</li> <li><strong>Quality:</strong> 84.6%</li> <li><strong>Sampling Speed:</strong> Faster than SAFE-GPT by 2.5x using $N=3$ parallel decoding</li> </ul> <p>GenMol demonstrates a tunable trade-off between quality and diversity through temperature ($\tau$) and randomness ($r$).</p> <h2 id="fragment-constrained-generation">Fragment-Constrained Generation</h2> <p>Using 10 drug scaffolds, GenMol outperforms SAFE-GPT in five sub-tasks: linker design, scaffold morphing, motif extension, scaffold decoration, and superstructure generation. It maintains high <strong>constraint adherence</strong> while improving novelty and structural diversity. For example:</p> <ul> <li><strong>Motif Extension Quality:</strong> 30.1% (vs. 18.6% in SAFE-GPT)</li> <li><strong>Superstructure Diversity:</strong> 0.599 (vs. 0.573)</li> </ul> <h2 id="goal-directed-hit-generation">Goal-Directed Hit Generation</h2> <p>Using the PMO benchmark (23 tasks), GenMol applies fragment remasking to optimize molecular properties. It achieves the best performance in 19/23 tasks and the highest total AUC:</p> \[\text{AUC}_{\text{top-10}}^{\text{sum}} = 18.362\] <p>Significantly surpassing f-RAG, Genetic GFN, and other leading baselines, GenMol’s improvements highlight the benefit of fragment-level exploration.</p> <h2 id="lead-optimization">Lead Optimization</h2> <p>GenMol performs constrained lead optimization under similarity thresholds $\delta = 0.4, 0.6$. On targets like JAK2, PARP1, and 5HT1B, it produces leads with:</p> <ul> <li>Lower binding affinity (more negative docking scores)</li> <li>High QED and low SA</li> <li>Preserved structural similarity</li> </ul> <p>It succeeds in 26/30 tasks, whereas other baselines frequently fail to meet all criteria.</p> <h2 id="ablation-studies">Ablation Studies</h2> <ul> <li><strong>Token-level remasking</strong> underperforms due to limited exploration.</li> <li><strong>Autoregressive GPT-style remasking</strong> degrades performance due to ordering constraints.</li> <li><strong>Removing MCG</strong> reduces goal-directed generation quality.</li> </ul> <p>Together, <strong>fragment remasking + MCG</strong> yields the best outcomes across diverse settings.</p> <h1 id="conclusion-and-future-work">Conclusion and Future Work</h1> <p><strong>GenMol</strong> introduces a generalist molecular generation framework that unifies diverse drug discovery tasks within a single model. By combining masked discrete diffusion, SAFE representation, and context-aware guidance, it outperforms task-specific baselines in efficiency, sample quality, and task generalization.</p> <p>Future work may include:</p> <ul> <li><strong>Integrating multimodal data</strong>, such as protein-ligand complexes.</li> <li><strong>Enhancing safety controls</strong> by excluding toxic fragments.</li> <li><strong>Scaling to larger molecular libraries</strong> and industrial pipelines.</li> </ul> <p>GenMol represents a promising step toward flexible and effective AI-powered drug discovery.</p>]]></content><author><name></name></author><summary type="html"><![CDATA[GenMol introduces a unified and versatile framework for molecular design using masked discrete diffusion on fragment-based molecular representations. By integrating bidirectional parallel decoding, fragment remasking, and molecular context guidance, GenMol tackles diverse drug discovery tasks such as de novo generation, fragment-constrained design, hit generation, and lead optimization. The model leverages non-autoregressive generation to improve efficiency and adaptivity, significantly outperforming task-specific baselines across multiple benchmarks.]]></summary></entry></feed>