<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <script>let thunk=()=>{let e=e=>e.trim(),t=e=>e.innerText,n=e=>{let t=e.split(" "),n=t.slice(0,-1).join(" ");return[t.at(-1),n]},a=Array.from(document.getElementsByClassName("author")).map(t).map(e).map(n),i=a[0][0],r=(Array.from(document.getElementsByClassName("affiliation")).filter(e=>"P"===e.nodeName).map(t).map(e),"June 1, 2025"),o="Molecule Generation with Fragment Retrieval Augmentation",l="This paper introduces f-RAG, a novel framework for molecular generation that enhances fragment-based drug discovery through retrieval-augmented generation. By combining hard and soft fragment retrieval with genetic fragment modification, f-RAG guides a pre-trained molecular language model (SAFE-GPT) to generate novel, diverse, and synthesizable molecules. Hard fragments serve as structural constraints, soft fragments provide contextual guidance via cross-attention, and genetic operations enable exploration beyond known chemical space. Extensive experiments on benchmarks demonstrate that f-RAG achieves state-of-the-art performance in optimizing molecular properties while maintaining high novelty and synthesizability.";{let e=a.map(e=>`${e[0]}, ${e[1]}`).join(" and "),t=`\n@inproceedings{${(i+"2025"+o.split(" ").slice(0,3).join("")).replace(" ","").replace(/[\p{P}$+<=>^`|~]/gu,"").toLowerCase().trim()},\n  author = {${e}},\n  title = {${o}},\n  abstract = {${l}},\n  booktitle = {ICLR Blogposts 2025},\n  year = {2025},\n  date = {${r}},\n  note = {${window.location.href}},\n  url  = {${window.location.href}}\n}\n  `.trim();document.getElementById("bibtex-box").innerText=t}{let e=a.map(e=>e[0]),t=`\n${e=e.length>2?e[0]+", et al.":2==e.length?e[0]+" & "+e[1]:e[0]}, "${o}", ICLR Blogposts, 2025.\n`.trim();document.getElementById("bibtex-academic-attribution").innerText=t}};document.addEventListener("readystatechange",function(){"complete"===document.readyState&&thunk()});</script> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Molecule Generation with Fragment Retrieval Augmentation | AI810 Blog Post (20238037)</title> <meta name="author" content="Jiyoun Kim"> <meta name="description" content="This paper introduces f-RAG, a novel framework for molecular generation that enhances fragment-based drug discovery through retrieval-augmented generation. By combining hard and soft fragment retrieval with genetic fragment modification, f-RAG guides a pre-trained molecular language model (SAFE-GPT) to generate novel, diverse, and synthesizable molecules. Hard fragments serve as structural constraints, soft fragments provide contextual guidance via cross-attention, and genetic operations enable exploration beyond known chemical space. Extensive experiments on benchmarks demonstrate that f-RAG achieves state-of-the-art performance in optimizing molecular properties while maintaining high novelty and synthesizability."> <meta name="keywords" content="machine-learning, ml, deep-learning, reinforcement-learning, iclr"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/iclr_favicon.ico"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://ai810-blog.github.io/blog/analysing-the-spectral-biases-in-generative-models/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> <d-front-matter> <script async type="text/json">{
      "title": "Molecule Generation with Fragment Retrieval Augmentation",
      "description": "This paper introduces f-RAG, a novel framework for molecular generation that enhances fragment-based drug discovery through retrieval-augmented generation. By combining hard and soft fragment retrieval with genetic fragment modification, f-RAG guides a pre-trained molecular language model (SAFE-GPT) to generate novel, diverse, and synthesizable molecules. Hard fragments serve as structural constraints, soft fragments provide contextual guidance via cross-attention, and genetic operations enable exploration beyond known chemical space. Extensive experiments on benchmarks demonstrate that f-RAG achieves state-of-the-art performance in optimizing molecular properties while maintaining high novelty and synthesizability.",
      "published": "June 1, 2025",
      "authors": [
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script> </d-front-matter> </head> <body class="fixed-top-nav"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">AI810 Blog Post (20238037)</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/about/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/index.html">blog</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="post distill"> <d-title> <h1>Molecule Generation with Fragment Retrieval Augmentation</h1> <p>This paper introduces f-RAG, a novel framework for molecular generation that enhances fragment-based drug discovery through retrieval-augmented generation. By combining hard and soft fragment retrieval with genetic fragment modification, f-RAG guides a pre-trained molecular language model (SAFE-GPT) to generate novel, diverse, and synthesizable molecules. Hard fragments serve as structural constraints, soft fragments provide contextual guidance via cross-attention, and genetic operations enable exploration beyond known chemical space. Extensive experiments on benchmarks demonstrate that f-RAG achieves state-of-the-art performance in optimizing molecular properties while maintaining high novelty and synthesizability.</p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div><a href="#introduction">Introduction</a></div> <div><a href="#related-work">Related Work</a></div> <ul> <li><a href="#fragment-based-molecule-generation">Fragment-based Molecule Generation</a></li> <li><a href="#retrieval-augmented-molecule-generation">Retrieval-Augmented Molecule Generation</a></li> </ul> <div><a href="#the-f-rag-framework">The f-RAG Framework</a></div> <ul> <li><a href="#hard-fragment-retrieval">Hard Fragment Retrieval</a></li> <li><a href="#soft-fragment-retrieval">Soft Fragment Retrieval</a></li> <li><a href="#genetic-fragment-modification">Genetic Fragment Modification</a></li> </ul> <div><a href="#training-the-f-rag-model">Training the f-RAG Model</a></div> <div><a href="#experimental-evaluation">Experimental Evaluation</a></div> <ul> <li><a href="#results-and-discussion">Results and Discussion</a></li> <li><a href="#ablation-studies">Ablation Studies</a></li> </ul> <div><a href="#conclusion-and-future-directions">Conclusion and Future Directions</a></div> </nav> </d-contents> <h1 id="molecule-generation-with-fragment-retrieval-augmentation-f-rag">Molecule Generation with Fragment Retrieval Augmentation (f-RAG)</h1> <h2 id="introduction">Introduction</h2> <p>Fragment-based drug discovery (FBDD) is a powerful approach in modern pharmaceutical research, enabling the construction of new molecules by assembling known molecular fragments. Despite its success, traditional FBDD methods often limit exploration to known chemical spaces, constraining the novelty and diversity of generated molecules. The research paper <strong>“Molecule Generation with Fragment Retrieval Augmentation (f-RAG)”</strong> addresses this limitation by proposing a novel framework that integrates retrieval-augmented generation to significantly enhance the exploration-exploitation trade-off in molecule generation.</p> <h2 id="related-work">Related Work</h2> <p>Fragment-based molecule generation typically recombines existing molecular fragments to build new molecules. Notable methods include Junction Tree VAE (JT-VAE)<d-cite key="jin2018junction"></d-cite>, which structures molecules by combining large substructures with smaller fragments. Techniques like MARS<d-cite key="xie2021mars"></d-cite> and reinforcement learning-based methods<d-cite key="yang2021hit"></d-cite> also iteratively add or remove fragments guided by chemical properties. Genetic algorithm-based methods<d-cite key="jensen2019graph"></d-cite> further enhance fragment assembly using crossover and mutation, yet remain limited by initial fragment pools.</p> <p>Retrieval-augmented generation (RAG)<d-cite key="borgeaud2022improving"></d-cite>, popularized in natural language processing, incorporates external contextual data to guide generative models. In molecular applications, retrieval augmentation methods often use entire molecules as retrieval units to influence generation<d-cite key="liu2024conversational"></d-cite>. This contrasts with f-RAG, which innovatively retrieves fragments to guide molecular construction more precisely, significantly enhancing chemical novelty and diversity.</p> <h2 id="the-f-rag-framework">The f-RAG Framework</h2> <p>The f-RAG framework strategically employs two fragment retrieval methods:</p> <h3 id="hard-fragment-retrieval">Hard Fragment Retrieval</h3> <p>Hard fragments explicitly become building blocks of newly generated molecules. Fragments are derived from known molecular structures using an arm-linker-arm decomposition approach. Each fragment’s relevance is quantified by assessing its contribution to desired molecular properties:</p> \[\text{score}(F_j) = \frac{1}{|S(F_j)|} \sum_{(x, y) \in S(F_j)} y,\] <p>where $S(F_j)$ denotes molecules containing fragment $F_j$, and $y$ is a measure of the desired property.</p> <p>The selected fragments form partial sequences, guiding generation via motif extensions or linker insertions. This direct inclusion ensures generated molecules retain meaningful chemical properties derived from existing fragments.</p> <h3 id="soft-fragment-retrieval">Soft Fragment Retrieval</h3> <p>Soft fragments indirectly guide molecule generation without direct inclusion in the final structure. They provide context to the generative model, aiding the prediction of novel molecular fragments through embedding augmentation. The embeddings for hard and soft fragments are computed separately and integrated using a cross-attention mechanism:</p> \[h_{\text{input}} = \text{LM}_{0:L}(x_{\text{input}}), \quad h_k^{\text{soft}} = \text{LM}_{0:L}(F_k^{\text{soft}}),\] <p>followed by:</p> \[h = \text{softmax}\left(\frac{\text{Query}(h_{\text{input}}) \cdot \text{Key}(H_{\text{soft}})^\top}{\sqrt{d_{\text{Key}}}}\right) \cdot \text{Value}(H_{\text{soft}}).\] <p>This integration significantly boosts the generation of novel and chemically plausible fragments, promoting exploration beyond existing fragment spaces.</p> <h3 id="genetic-fragment-modification">Genetic Fragment Modification</h3> <p>To further enhance molecular novelty, genetic algorithms (GA) are employed post-generation. Using crossover and mutation operations, the GA continuously diversifies the fragment population, allowing exploration into previously uncharted chemical spaces.</p> <h2 id="training-the-f-rag-model">Training the f-RAG Model</h2> <p>f-RAG relies on the pre-trained molecular language model SAFE-GPT, keeping it frozen to preserve its extensive chemical knowledge. Training focuses exclusively on a lightweight fragment injection module with a self-supervised objective. This training involves decomposing molecules into fragments and predicting the most similar fragment based on embeddings, efficiently teaching the model to utilize soft fragments for informative guidance.</p> <h2 id="experimental-evaluation">Experimental Evaluation</h2> <p>f-RAG was extensively evaluated on multiple tasks, including the Practical Molecular Optimization (PMO) benchmark and tasks focused on optimizing docking scores, quantitative estimates of drug-likeness (QED), synthetic accessibility (SA), and molecular novelty.</p> <h3 id="results-and-discussion">Results and Discussion</h3> <p>f-RAG consistently outperformed existing methods on several metrics:</p> <ul> <li> <strong>Optimization Performance:</strong> Achieved state-of-the-art performance across 12 out of 23 PMO benchmark tasks, significantly surpassing traditional and recent baselines.</li> <li> <strong>Diversity, Novelty, Synthesizability:</strong> Maintained superior balance among these criteria, demonstrating an effective exploration-exploitation trade-off and generating high-quality drug candidates.</li> <li> <strong>Docking Score Optimization:</strong> Produced molecules with higher binding affinities and improved drug-likeness and synthesizability across various protein targets.</li> </ul> <h3 id="ablation-studies">Ablation Studies</h3> <p>Detailed ablation studies underscored the essential contributions of each f-RAG component (hard retrieval, soft retrieval, genetic modifications). Particularly, soft fragment retrieval was crucial in achieving high molecular diversity and novelty without sacrificing performance.</p> <h2 id="conclusion-and-future-directions">Conclusion and Future Directions</h2> <p>f-RAG significantly advances fragment-based drug discovery through innovative retrieval augmentation and genetic modification techniques. Its robust performance across diverse evaluation criteria confirms its potential in practical drug discovery applications.</p> <p>Future research directions include:</p> <ul> <li> <strong>Adaptive Retrieval Strategies:</strong> Dynamically adjusting retrieval strategies based on ongoing molecular population performance.</li> <li> <strong>Multi-modal Data Integration:</strong> Incorporating additional modalities such as textual or structural biological data into the fragment retrieval process.</li> <li> <strong>Scalability:</strong> Extending f-RAG to larger chemical libraries and more complex molecular scenarios, validating its applicability and robustness on broader scales.</li> </ul> <h2 id="code-availability">Code availability</h2> <p>The official code written by the authors for reproduction can be found at <a href="https://github.com/NVlabs/f-RAG" rel="external nofollow noopener noopener noreferrer" target="_blank">https://github.com/NVlabs/f-RAG</a>.</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> </div> <d-bibliography src="/assets/bibliography/2025-04-28-f-rag.bib"></d-bibliography> <d-article id="bibtex-container" class="related highlight"> For attribution in academic contexts, please cite this work as <pre id="bibtex-academic-attribution">
        PLACEHOLDER FOR ACADEMIC ATTRIBUTION
  </pre> BibTeX citation <pre id="bibtex-box">
        PLACEHOLDER FOR BIBTEX
  </pre> </d-article> <script src="https://utteranc.es/client.js" repo="iclr-blogposts/2025" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> </body> </html>