<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <script>let thunk=()=>{let e=e=>e.trim(),n=e=>e.innerText,t=e=>{let n=e.split(" "),t=n.slice(0,-1).join(" ");return[n.at(-1),t]},i=Array.from(document.getElementsByClassName("author")).map(n).map(e).map(t),a=i[0][0],o=(Array.from(document.getElementsByClassName("affiliation")).filter(e=>"P"===e.nodeName).map(n).map(e),"June 1, 2025"),r="GenMol: A Drug Discovery Generalist with Discrete Diffusion",s="GenMol introduces a unified and versatile framework for molecular design using masked discrete diffusion on fragment-based molecular representations. By integrating bidirectional parallel decoding, fragment remasking, and molecular context guidance, GenMol tackles diverse drug discovery tasks such as de novo generation, fragment-constrained design, hit generation, and lead optimization. The model leverages non-autoregressive generation to improve efficiency and adaptivity, significantly outperforming task-specific baselines across multiple benchmarks.";{let e=i.map(e=>`${e[0]}, ${e[1]}`).join(" and "),n=`\n@inproceedings{${(a+"2025"+r.split(" ").slice(0,3).join("")).replace(" ","").replace(/[\p{P}$+<=>^`|~]/gu,"").toLowerCase().trim()},\n  author = {${e}},\n  title = {${r}},\n  abstract = {${s}},\n  booktitle = {ICLR Blogposts 2025},\n  year = {2025},\n  date = {${o}},\n  note = {${window.location.href}},\n  url  = {${window.location.href}}\n}\n  `.trim();document.getElementById("bibtex-box").innerText=n}{let e=i.map(e=>e[0]),n=`\n${e=e.length>2?e[0]+", et al.":2==e.length?e[0]+" & "+e[1]:e[0]}, "${r}", ICLR Blogposts, 2025.\n`.trim();document.getElementById("bibtex-academic-attribution").innerText=n}};document.addEventListener("readystatechange",function(){"complete"===document.readyState&&thunk()});</script> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>GenMol: A Drug Discovery Generalist with Discrete Diffusion | AI810 Blog Post (20238037)</title> <meta name="author" content="Jiyoun Kim"> <meta name="description" content="GenMol introduces a unified and versatile framework for molecular design using masked discrete diffusion on fragment-based molecular representations. By integrating bidirectional parallel decoding, fragment remasking, and molecular context guidance, GenMol tackles diverse drug discovery tasks such as de novo generation, fragment-constrained design, hit generation, and lead optimization. The model leverages non-autoregressive generation to improve efficiency and adaptivity, significantly outperforming task-specific baselines across multiple benchmarks."> <meta name="keywords" content="machine-learning, ml, deep-learning, reinforcement-learning, iclr"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/iclr_favicon.ico"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://ai810-blog.github.io/blog/analytical-simulated-dynamics/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> <d-front-matter> <script async type="text/json">{
      "title": "GenMol: A Drug Discovery Generalist with Discrete Diffusion",
      "description": "GenMol introduces a unified and versatile framework for molecular design using masked discrete diffusion on fragment-based molecular representations. By integrating bidirectional parallel decoding, fragment remasking, and molecular context guidance, GenMol tackles diverse drug discovery tasks such as de novo generation, fragment-constrained design, hit generation, and lead optimization. The model leverages non-autoregressive generation to improve efficiency and adaptivity, significantly outperforming task-specific baselines across multiple benchmarks.",
      "published": "June 1, 2025",
      "authors": [
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script> </d-front-matter> </head> <body class="fixed-top-nav"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">AI810 Blog Post (20238037)</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/about/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/index.html">blog</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="post distill"> <d-title> <h1>GenMol: A Drug Discovery Generalist with Discrete Diffusion</h1> <p>GenMol introduces a unified and versatile framework for molecular design using masked discrete diffusion on fragment-based molecular representations. By integrating bidirectional parallel decoding, fragment remasking, and molecular context guidance, GenMol tackles diverse drug discovery tasks such as de novo generation, fragment-constrained design, hit generation, and lead optimization. The model leverages non-autoregressive generation to improve efficiency and adaptivity, significantly outperforming task-specific baselines across multiple benchmarks.</p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div><a href="#introduction">Introduction</a></div> <div><a href="#related-work">Related Work</a></div> <ul> <li><a href="#discrete-diffusion-models">Discrete Diffusion Models</a></li> <li><a href="#fragment-based-molecular-generation">Fragment-based Molecular Generation</a></li> </ul> <div><a href="#background">Background</a></div> <ul> <li><a href="#masked-discrete-diffusion">Masked Discrete Diffusion</a></li> <li><a href="#safe-molecular-representation">SAFE Molecular Representation</a></li> </ul> <div><a href="#genmol-framework">GenMol Framework</a></div> <ul> <li><a href="#masked-diffusion-architecture">Masked Diffusion Architecture</a></li> <li><a href="#fragment-remasking">Fragment Remasking</a></li> <li><a href="#molecular-context-guidance">Molecular Context Guidance</a></li> </ul> <div><a href="#experimental-evaluation">Experimental Evaluation</a></div> <ul> <li><a href="#de-novo-generation">De Novo Generation</a></li> <li><a href="#fragment-constrained-generation">Fragment-Constrained Generation</a></li> <li><a href="#goal-directed-hit-generation">Goal-Directed Hit Generation</a></li> <li><a href="#lead-optimization">Lead Optimization</a></li> <li><a href="#ablation-studies">Ablation Studies</a></li> </ul> <div><a href="#conclusion-and-future-work">Conclusion and Future Work</a></div> </nav> </d-contents> <h1 id="introduction">Introduction</h1> <p>Drug discovery is a multifaceted process that involves stages such as de novo generation, fragment-constrained design, hit identification, and lead optimization. Traditional generative models often specialize in specific tasks, requiring task-specific architectures or expensive retraining for new objectives. <strong>GenMol</strong> addresses this limitation by offering a <strong>generalist molecular generation framework</strong> based on <strong>masked discrete diffusion</strong> over <strong>fragment-based molecular representations (SAFE)</strong>. This approach allows GenMol to serve as a unified model across different phases of drug discovery with enhanced efficiency, flexibility, and chemical fidelity. Unlike prior autoregressive methods, GenMol enables <strong>bidirectional parallel decoding</strong> and effective <strong>contextual guidance</strong>, improving sample quality and reducing inference time.</p> <h1 id="related-work">Related Work</h1> <p><strong>Discrete Diffusion Models:</strong> Discrete diffusion has recently emerged as a compelling approach for generative modeling of categorical data. D3PM<d-cite key="peng2022d3pm"></d-cite> introduces the notion of forward masking via transition matrices and backward denoising conditioned on time. MDLM<d-cite key="sahoo2024simple"></d-cite>, adopted by GenMol, simplifies this by formulating the training as a time-weighted sum of masked language modeling (MLM) losses. This framework has shown promise in NLP but remains underexplored in molecular generation.</p> <p><strong>Fragment-based Molecular Generation:</strong> Fragment-based drug design (FBDD) focuses on assembling known chemical fragments to build novel molecules. Earlier methods like graph-based VAEs<d-cite key="jin2020multi"></d-cite>, RL-based molecule completion<d-cite key="yang2021hit"></d-cite>, and genetic algorithms<d-cite key="jensen2019graph"></d-cite> have utilized fragments as building blocks. However, these models often suffer from limited diversity or require extensive retraining for new tasks. More recent work such as f-RAG enhances fragment utility through retrieval-augmented generation, but still lacks the unification across multiple generation tasks.</p> <h1 id="background">Background</h1> <h2 id="masked-discrete-diffusion">Masked Discrete Diffusion</h2> <p>In masked discrete diffusion, a clean sequence $\mathbf{x}$ is progressively corrupted into a fully masked sequence $\mathbf{z}^t$ through a forward process:</p> \[q(\mathbf{z}^t_l | \mathbf{x}_l) = \text{Cat}(\alpha_t \mathbf{x}_l + (1 - \alpha_t) \mathbf{m})\] <p>Here, $\alpha_t$ denotes the retention probability of the original token. The reverse process is trained to recover $\mathbf{x}$ by predicting token distributions from masked sequences. The training objective integrates cross-entropy losses over all time steps:</p> \[\mathcal{L}_{\text{NELBO}} = \mathbb{E}_q \int_0^1 \frac{\alpha'_t}{1 - \alpha_t} \sum_l \log \langle \mathbf{x}_{\theta, l}(\mathbf{z}^t, t), \mathbf{x}_l \rangle \, dt\] <h2 id="safe-molecular-representation">SAFE Molecular Representation</h2> <p>SAFE encodes molecules as an unordered sequence of fragments, each represented by a contiguous block of non-canonical SMILES tokens. These fragments are extracted using the BRICS algorithm and joined with attachment point markers. Unlike traditional SMILES or graph representations, SAFE maintains permutation invariance on fragment order, making it ideal for <strong>non-autoregressive</strong> generation. This also enables intuitive operations like fragment masking and replacement for goal-directed tasks.</p> <h1 id="genmol-framework">GenMol Framework</h1> <h2 id="masked-diffusion-architecture">Masked Diffusion Architecture</h2> <p>GenMol utilizes a BERT-based transformer trained using the masked discrete diffusion objective over SAFE sequences. The key advantages are:</p> <ol> <li> <strong>Parallel Decoding:</strong> Tokens are predicted simultaneously, accelerating generation.</li> <li> <strong>Bidirectional Attention:</strong> The model conditions predictions on full context, improving coherence.</li> <li> <strong>Fragment-Level Semantics:</strong> By operating on fragments, GenMol better aligns with chemists’ reasoning.</li> </ol> <p>The reverse sampling from the model is defined using temperature-controlled confidence sampling:</p> \[p^l_{\theta, i} = \frac{\exp(\log x^l_{\theta, i}(\mathbf{z}^t, t)/\tau)}{\sum_j \exp(\log x^l_{\theta, j}(\mathbf{z}^t, t)/\tau)}\] <h2 id="fragment-remasking">Fragment Remasking</h2> <p>To optimize molecules, GenMol introduces <strong>fragment remasking</strong>: a fragment in a candidate molecule is randomly selected, masked, and regenerated via diffusion. This facilitates local exploration:</p> \[y(f_k) = \frac{1}{|\mathcal{S}(f_k)|} \sum_{\mathbf{x} \in \mathcal{S}(f_k)} y(\mathbf{x})\] <p>Fragments with high average scores are favored for vocabulary updates, enabling iterative refinement. The remasking mechanism is analogous to Gibbs sampling over fragment configurations, promoting controlled diversity and optimization.</p> <h2 id="molecular-context-guidance-mcg">Molecular Context Guidance (MCG)</h2> <p>MCG provides <strong>classifier-free guidance</strong> for discrete diffusion. It interpolates between predictions on a given input and its noisier variant:</p> \[\log x^{(w)}_{\theta, l, i} = w \log x_{\theta, l, i} + (1 - w) \log x'_{\theta, l, i}\] <p>Here, $x’_{\theta}$ is the model’s output on a more degraded (further masked) version of the input. This guidance boosts sample quality in tasks requiring conditional generation.</p> <h1 id="experimental-evaluation">Experimental Evaluation</h1> <h2 id="de-novo-generation">De Novo Generation</h2> <p>GenMol generates 1,000 molecules and measures validity, uniqueness, diversity, and a composite <strong>quality</strong> metric (valid + QED ≥ 0.6 + SA ≤ 4). Results show:</p> <ul> <li> <strong>Validity:</strong> 100%</li> <li> <strong>Uniqueness:</strong> 99.7%</li> <li> <strong>Quality:</strong> 84.6%</li> <li> <strong>Sampling Speed:</strong> Faster than SAFE-GPT by 2.5x using $N=3$ parallel decoding</li> </ul> <p>GenMol demonstrates a tunable trade-off between quality and diversity through temperature ($\tau$) and randomness ($r$).</p> <h2 id="fragment-constrained-generation">Fragment-Constrained Generation</h2> <p>Using 10 drug scaffolds, GenMol outperforms SAFE-GPT in five sub-tasks: linker design, scaffold morphing, motif extension, scaffold decoration, and superstructure generation. It maintains high <strong>constraint adherence</strong> while improving novelty and structural diversity. For example:</p> <ul> <li> <strong>Motif Extension Quality:</strong> 30.1% (vs. 18.6% in SAFE-GPT)</li> <li> <strong>Superstructure Diversity:</strong> 0.599 (vs. 0.573)</li> </ul> <h2 id="goal-directed-hit-generation">Goal-Directed Hit Generation</h2> <p>Using the PMO benchmark (23 tasks), GenMol applies fragment remasking to optimize molecular properties. It achieves the best performance in 19/23 tasks and the highest total AUC:</p> \[\text{AUC}_{\text{top-10}}^{\text{sum}} = 18.362\] <p>Significantly surpassing f-RAG, Genetic GFN, and other leading baselines, GenMol’s improvements highlight the benefit of fragment-level exploration.</p> <h2 id="lead-optimization">Lead Optimization</h2> <p>GenMol performs constrained lead optimization under similarity thresholds $\delta = 0.4, 0.6$. On targets like JAK2, PARP1, and 5HT1B, it produces leads with:</p> <ul> <li>Lower binding affinity (more negative docking scores)</li> <li>High QED and low SA</li> <li>Preserved structural similarity</li> </ul> <p>It succeeds in 26/30 tasks, whereas other baselines frequently fail to meet all criteria.</p> <h2 id="ablation-studies">Ablation Studies</h2> <ul> <li> <strong>Token-level remasking</strong> underperforms due to limited exploration.</li> <li> <strong>Autoregressive GPT-style remasking</strong> degrades performance due to ordering constraints.</li> <li> <strong>Removing MCG</strong> reduces goal-directed generation quality.</li> </ul> <p>Together, <strong>fragment remasking + MCG</strong> yields the best outcomes across diverse settings.</p> <h1 id="conclusion-and-future-work">Conclusion and Future Work</h1> <p><strong>GenMol</strong> introduces a generalist molecular generation framework that unifies diverse drug discovery tasks within a single model. By combining masked discrete diffusion, SAFE representation, and context-aware guidance, it outperforms task-specific baselines in efficiency, sample quality, and task generalization.</p> <p>Future work may include:</p> <ul> <li> <strong>Integrating multimodal data</strong>, such as protein-ligand complexes.</li> <li> <strong>Enhancing safety controls</strong> by excluding toxic fragments.</li> <li> <strong>Scaling to larger molecular libraries</strong> and industrial pipelines.</li> </ul> <p>GenMol represents a promising step toward flexible and effective AI-powered drug discovery.</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> </div> <d-bibliography src="/assets/bibliography/2025-04-28-genmol.bib"></d-bibliography> <d-article id="bibtex-container" class="related highlight"> For attribution in academic contexts, please cite this work as <pre id="bibtex-academic-attribution">
        PLACEHOLDER FOR ACADEMIC ATTRIBUTION
  </pre> BibTeX citation <pre id="bibtex-box">
        PLACEHOLDER FOR BIBTEX
  </pre> </d-article> <script src="https://utteranc.es/client.js" repo="iclr-blogposts/2025" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> </body> </html>